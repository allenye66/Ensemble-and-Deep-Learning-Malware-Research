import pandas as pd
import numpy as np
import sklearn.metrics as metrics
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.datasets import make_classification
import matplotlib.pyplot as plt
from sklearn.metrics import confusion_matrix
from sklearn.utils.multiclass import unique_labels

df = pd.read_csv('/Users/allen/Desktop/Malware-Research/csv/all_data.csv')


df = df.loc[:, df.columns != 'Total Opcodes']

for i in range(31):
    df = df.drop(df.columns[1], axis=1)



opcode_sequence = (df.drop(df.columns[0], axis=1))
opcode_sequence = np.asarray(opcode_sequence)


labels = np.asarray(df[['Family']].copy())



X_train, X_test, y_train, y_test = train_test_split(opcode_sequence, labels, test_size=0.20, random_state=42)

from sklearn.ensemble import AdaBoostClassifier
from sklearn.datasets import make_classification

clf = AdaBoostClassifier(n_estimators=50, random_state=42)
clf.fit(X_train, y_train)
preds = clf.predict(X_test)
accuracy = metrics.accuracy_score(y_test, preds)
print(accuracy)



##48.6%
#test size = 0.2
#random state = 42 
#n estimators = 100 #changing to 200 lowers accuracy to 39% #changing to 50 lowers to 44
#random state = 0 #no effect changing to 42