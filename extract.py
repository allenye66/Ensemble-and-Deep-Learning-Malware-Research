import r2pipe
import processOutput
from processOutput import process
from os import listdir

def iterate(foldername):
	for f in listdir(foldername):
 		print(f)
def extract_write(filename):
	r = r2pipe.open(filename)
	##any command that one runs in the r2 shell can be passed to the cmd method
	#print(r.cmd('pd'))
	#print(r.cmd('v'))
	#print(r.cmd)
	#s = r.cmd("pd[dD]")
	#pd > output.txt #for terminal

	s = r.cmd("pd")
	
	##create new text file name
	slash = filename.rfind("/")
	#print(slash)
	txt_file = filename[slash + 1:] + ".txt"
	#print(txt_file)

	f = open(txt_file, "w+")
	f.write(s)
	f.close()
	return (str(txt_file))
	#return ('"%s"' % str(txt_file))


	#f = open("output.txt", "w") #create new text file and write to it
	#f.write(s)
	#f.close()

if __name__ == "__main__":
	
	#print((extract_write("/Users/allen/Desktop/v001/VirusShare_fffb1996a5b7c4c716931af2842712e3")))
	s = ((extract_write("/Users/allen/Desktop/v001/VirusShare_fffb1996a5b7c4c716931af2842712e3")))
	#print(s)
	process(s)
	#process("VirusShare_fffb1996a5b7c4c716931af2842712e3.txt")	
	#iterate("/Users/allen/Desktop/v001")