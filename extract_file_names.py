import pandas as pd
df = pd.read_csv("/Users/allen/Desktop/Malware-Research/00001.csv")
files_to_decode = df[["file_name", "name"]]

'''
name_set = set()
for index, row in files_to_decode.iterrows():
	name_set.add(row['name'])
print(name_set)
'''

number_of_families = 10
families = files_to_decode['name'].value_counts()[:number_of_families].index.tolist()
print(families)



''''
vbinject = 0
winwebsec = 0
renos = 0
onlinegames = 0
bho = 0
startpage = 0
adload = 0
vb = 0
vobfus = 0
ceeinject = 0
'''
vbinject = []
winwebsec = []
renos = []
onlinegames =[]
bho = []
startpage = []
adload = []
vb = []
vobfus = []
ceeinject = []
for index, row in files_to_decode.iterrows():
	if row['name'] == "VBInject":
		vbinject.append(row['file_name'])
	if row['name'] == "Winwebsec":
		winwebsec.append(row['file_name'])
	if row['name'] == 'Renos':
		renos.append(row['file_name'])
	if row['name'] == 'OnLineGames':
		onlinegames.append(row['file_name'])
	if row['name'] == 'BHO':
		bho.append(row['file_name'])
	if row['name'] == "Startpage":
		startpage.append(row['file_name'])
	if row['name'] == 'Adload':
		adload.append(row['file_name'])
	if row['name'] == 'VB':
		vb.append(row['file_name'])
	if row['name'] == 'Vobfus':
		vobfus.append(row['file_name'])
	if row['name'] == 'CeeInject':
		ceeinject.append(row['file_name'])
		#print(row["file_name"])

'''
print("vbinject",vbinject )
print("winwebsec",winwebsec )
print("renos",renos )
print("onlinegames",onlinegames )
print("bho",bho )
print("startpage",startpage )
print("adload",adload )
print("vb",vb )
print("vobfus",vobfus )
print("ceeinject",ceeinject )

'''
print("vbinject",len(vbinject))
print("winwebsec", len(winwebsec))
print("renos", len(renos))
print("onlinegames", len(onlinegames))
print("bho", len(bho))
print("startpage", len(startpage ))
print("adload", len(adload ))
print("vb", len(vb))
print("vobfus", len(vobfus ))
print("ceeinject", len(ceeinject ))



with open("/Users/allen/Desktop/Malware-Research/extract_these_files/winwebsec_files.txt", "w") as txt_file:
		for line in winwebsec:
			txt_file.write("".join(line))
			txt_file.write("\n")

with open("/Users/allen/Desktop/Malware-Research/extract_these_files/vobfus_files.txt", "w") as txt_file:
		for line in vobfus:
			txt_file.write("".join(line))
			txt_file.write("\n")


with open("/Users/allen/Desktop/Malware-Research/extract_these_files/vbinject_files.txt", "w") as txt_file:
		for line in vbinject:
			txt_file.write("".join(line))
			txt_file.write("\n")

with open("/Users/allen/Desktop/Malware-Research/extract_these_files/vb_files.txt", "w") as txt_file:
		for line in vb:
			txt_file.write("".join(line))
			txt_file.write("\n")

with open("/Users/allen/Desktop/Malware-Research/extract_these_files/startpage_files.txt", "w") as txt_file:
		for line in startpage:
			txt_file.write("".join(line))
			txt_file.write("\n")

with open("/Users/allen/Desktop/Malware-Research/extract_these_files/renos_files.txt", "w") as txt_file:
		for line in renos:
			txt_file.write("".join(line))
			txt_file.write("\n")

with open("/Users/allen/Desktop/Malware-Research/extract_these_files/onlinegames_files.txt", "w") as txt_file:
		for line in onlinegames:
			txt_file.write("".join(line))
			txt_file.write("\n")

with open("/Users/allen/Desktop/Malware-Research/extract_these_files/ceeinject_files.txt", "w") as txt_file:
		for line in ceeinject:
			txt_file.write("".join(line))
			txt_file.write("\n")

with open("/Users/allen/Desktop/Malware-Research/extract_these_files/bho_files.txt", "w") as txt_file:
		for line in bho:
			txt_file.write("".join(line))
			txt_file.write("\n")

with open("/Users/allen/Desktop/Malware-Research/extract_these_files/adload_files.txt", "w") as txt_file:
		for line in adload:
			txt_file.write("".join(line))
			txt_file.write("\n")