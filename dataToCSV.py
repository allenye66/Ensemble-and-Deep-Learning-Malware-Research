
import csv
import os

'''
def countOpcodes(filename):
	with open(filename) as f:
			s = set()
			for word in f:
				s.add(word.rstrip())
	#s = getUniqueOpcodes(filename)
		#print(s)
		#print(len(s))

	d = {}
	for word in s:
		d[word] = 0
	with open(filename) as f:
		for word in f:
			word = word.rstrip()
			d[word] += 1

	d=sorted(d.items(), key=lambda x: x[1], reverse = True)
	#print(d)
	#print(type(d))

	arr = []
	for key, value in d:
	    arr.append(key)


	return arr,d
		#print(d)


#problem, each file has diff opcodes
#traverse through each text file adding the opcodes to a set and make that set part of the header
#if an opcode in the header is not in the dict list, set the dict list to 0
'''
if __name__ == '__main__':

	header = ['Family', 'Total Opcodes', 'mov', 'push', 'call', 'lea', 'add', 'jae', 'inc', 'cmp', 'sub', 'jmp', 'dec', 'shl', 'pop', 'xchg', 'je', 'jne', 'xor', 'test', 'ret', 'jo', 'imul', 'and', 'in', 'jge', 'outsb', 'fstp', 'sbb', 'adc', 'jp', 'insb']

	n_features = 1000
	for i in range(n_features):
		header.append("Opcode: " + str(i))
	with open('zbot.csv', 'w') as g:

	        writer = csv.writer(g)
	        writer.writerow(header)
	        #for filename in os.listdir('/Users/allen/Desktop/ExtractedOpcodes/zbot_opcodes'):


	        #for every file inside zbot folder:
	        	#count the opcodes and add a new row