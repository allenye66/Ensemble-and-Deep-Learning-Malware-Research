import csv
def countOpcodes(filename):
	with open(filename) as f:
			s = set()
			for word in f:
				s.add(word.rstrip())
	#s = getUniqueOpcodes(filename)
		#print(s)
		#print(len(s))

	d = {}
	for word in s:
		d[word] = 0
	with open(filename) as f:
		for word in f:
			word = word.rstrip()
			d[word] += 1

	d=sorted(d.items(), key=lambda x: x[1], reverse = True)
	#print(d)
	#print(type(d))

	arr = []
	for key, value in d:
	    arr.append(key)


	return arr,d
		#print(d)


	
if __name__ == '__main__':
	filename = '/Users/allen/Desktop/ExtractedOpcodes/zbot_opcodes/VirusShare_ffe74ee3de089d05d105a9127eff5ec9.txt'
	header, dictionary = countOpcodes(filename)
	print(header)
	with open('zbot.csv', 'w') as g:
	        writer = csv.writer(g)
	       	header.insert(0, 'Total Opcodes')
	        header.insert(0, 'Family')
	        print(header)
	        writer.writerow(header)